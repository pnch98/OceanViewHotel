@{
    ViewData["Title"] = "Async";
}
<div id="divCodice" class="mb-5">
        <label class="control-label">Inserisci codice fiscale</label>
        <input id="inputValue" class="mb-3" placeholder="Codice Fiscale" />
        <div class="form-group">
            <input type="button" id="btnSearch" value="Cerca" class="oceanBtn" />
        </div>

</div>
<div id="divPensioni">
</div>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $("#btnSearch").submit(function (event) {
            event.preventDefault(); // Evita il comportamento di default del form (refresh della pagina)

            var codiceFiscale = $("#inputValue").val();
            FetchByCodiceFiscale(codiceFiscale);
        });

        // Chiamata iniziale alla funzione FetchTotalePensioniComplete
        FetchTotalePensioniComplete();
    });

    async function FetchByCodiceFiscale(codiceFiscale) {
        try {
            const response = await fetch('/Home/FetchByCodiceFiscale?codiceFiscale=' + codiceFiscale);

            if (!response.ok) {
                throw new Error('Errore nella richiesta fetch');
            }

            const data = await response.json();
            console.log(data);
            const container = $('#divCodice');
            container.empty();
            container.append(data);
        } catch (error) {
            console.error('Error:', error);
        }
    }

    async function FetchTotalePensioniComplete() {
        try {
            const response = await fetch('/Home/FetchTotalePensioniComplete');
            const data = await response.json();

            const container = $('#divPensioni');
            container.empty();
            container.append('<h3>Totale Pensioni Complete: ' + data + '</h3>');
        }
        catch (error) {
            console.error('Error:', error);
        }
    }
</script>
